import boto3

session = boto3.Session(profile_name='dclouddev')

dynamodb = session.resource('dynamodb')

table = dynamodb.Table('wowquesttracker_questlinesv3')

quest_lines = {
    "You Are Now Prepared (Argus)": [47221, 47835, 47222, 47867, 47223, 47224, 48440, 46938, 47589, 46297, 48483, 47627, 47641, 46732, 46816, 46839, 46840, 46841, 46842, 46843, 48500, 47431, 40238, 46213, 47541, 47508, 47771, 47526, 47754, 47652, 47653, 47743, 49143, 48559, 47287, 48199, 48200, 48201, 48202, 48929, 47889, 47890, 47891, 47892, 47986, 47987, 47988, 47991, 47990, 47989, 47992, 47993, 47994, 48081, 46815, 46818, 46834, 47066, 46941, 47686, 47882, 47688, 47883, 47689, 47685, 47687, 47690, 48107, 48461, 48344, 47691, 47854, 47995, 47853, 48345, 47855, 47856, 47416, 47238, 40761, 47101, 47180, 47100, 47183, 47184, 47203, 47217, 47218, 47219, 47220, 48560, 49224, 47654],
    "Light's Heart": [42866, 44009, 44004, 43705, 44153, 44337, 44448, 44464, 44466, 44479, 44414, 44415, 44416, 44480, 44481, 45174, 45175, 45176, 45177],
    "Balance of Power": [43496, 40668, 43514, 43517, 43518, 43519, 43581, 43520, 43521, 43522, 43523, 40673, 43525, 40675, 43524, 40678, 43526, 40603, 40608, 40613, 40614, 40672, 40615, 43528, 43531, 43530, 43532, 43533],
    "Breaching the Tomb": [46730, 46734, 47067, 46286, 46832, 46845, 46499, 46501, 46509, 46510, 46511, 46666, 46245, 46772, 46773, 46774, 46244, 46247, 47137, 46251, 47139, 46248, 46252, 46769, 46250, 46249, 46246],
    "Good Suramaritan": [42230, 44636, 44561, 41877, 40746, 41148, 40947, 40745, 42722, 42486, 42487, 42488, 42489, 41878, 40727, 40730, 42828, 42829, 42832, 42833, 42834, 42835, 42837, 42836, 42838, 44084, 42839, 43969, 42840, 42841, 43352, 42792, 44052, 43309, 43311, 43315, 43313, 43310, 43312, 44040, 43317, 43318, 44053, 42490, 43314, 42491, 44562, 44152, 43361, 43360, 44156, 40125, 43362, 43502, 43562, 43563, 43564, 43565, 43566, 43567, 43568, 43569],
    "Insurrection": [45260, 38649, 38695, 38692, 38720, 38694, 42889, 44955, 45261, 44722, 44724, 44723, 44725, 44726, 44727, 44814, 45262, 44742, 44752, 44753, 44754, 44756, 45316, 45263, 40391, 43810, 41916, 44831, 44834, 44842, 44843, 44844, 44845, 45265, 44743, 44870, 44858, 44928, 44861, 44827, 44829, 44830, 44790, 45266, 44739, 44738, 44740, 45317, 45267, 44736, 44822, 45209, 44832, 44833, 45268, 44918, 44919, 45063, 45067, 45062, 45065, 45066, 45064, 45269, 44964, 44719, 45417, 45372],
    "Nightfallen But Not Forgotten": [44555, 39986, 39987, 40008, 40123, 40009, 42229, 44672, 40011, 40747, 40748, 40830, 44691, 40956, 40012, 41149, 40326, 41702, 41704, 41760, 41762, 41834, 41989, 42079, 42147, 40010, 41028, 40368, 40348, 40370, 41138, 44492, 40324, 40325, 42224, 42225, 42226, 42227, 42228, 42230],
    "Shaman Class Campaign": [39746, 41335, 43334, 43338, 39771, 43644, 43645, 40341, 42931, 42932, 42933, 42935, 42936, 42937, 40224, 40225, 40276, 41510, 44544, 42188, 42114, 42383, 42198, 42197, 42141, 42142, 41741, 41740, 42184, 44101, 42977, 43002, 41770, 41771, 41776, 41742, 41743, 44465, 42986, 42996, 42983, 42984, 44253, 43886, 41901, 42200, 41775, 42068, 41777, 41897, 41898, 41899, 42065, 41900, 41746, 41747, 42208, 41772, 42988, 42995, 43003, 42990, 41773, 41934, 41888, 41744, 41745, 43418],
    "Death Knight Class Campaign": [40714, 40715, 40740, 38990, 40930, 40931, 40932, 40933, 40934, 40935, 39757, 39761, 39832, 39799, 42449, 42484, 44550, 43264, 39818, 39816, 43265, 43266, 43267, 43539, 43268, 42533, 42534, 42535, 42536, 42537, 44243, 42708, 44244, 43899, 44082, 43571, 43572, 44217, 42818, 42882, 42821, 42823, 42824, 44245, 43573, 43928, 44690, 44286, 44246, 44282, 44247, 43574, 43686, 44248, 43407],
    "Rogue Class Campaign": [40832, 40839, 40840, 42501, 42502, 42503, 42539, 42568, 42627, 40847, 40849, 41919, 41920, 41921, 41922, 41924, 40950, 40994, 40995, 43007, 42139, 42140, 43013, 43014, 43015, 43958, 43829, 44041, 44116, 44155, 44117, 44177, 44183, 43841, 43852, 44181, 42684, 43468, 43253, 43249, 43250, 44252, 42730, 43885, 44178, 44180, 43251, 43252, 42678, 42680, 42800, 43469, 43470, 43479, 43485, 43508, 37666, 37448, 37494, 37689, 43723, 43724, 44215, 43422],
    "Demon Hunter Class Campaign": [39261, 40814, 41120, 41121, 41119, 40247, 41804, 41806, 41807, 40249, 42869, 42872, 41033, 41037, 41062, 41064, 44087, 42671, 42677, 42679, 42681, 42683, 42682, 37447, 42510, 42522, 42593, 42594, 42921, 42665, 42131, 42731, 42801, 42787, 42735, 42736, 42737, 42739, 42738, 42749, 42752, 42775, 42776, 42669, 42802, 42808, 43878, 44213, 44694, 42733, 44616, 42732, 42754, 42810, 42920, 42132, 43186, 44214, 43412],
    "Warrior Class Campaign": [42814, 41052, 42815, 38904, 39654, 40579, 41105, 40043, 39191, 39530, 39192, 39214, 40585, 42597, 42484, 42598, 42606, 42605, 42607, 42609, 42610, 42611, 42193, 42650, 42651, 42107, 42614, 42110, 42204, 43585, 43975, 44255, 43888, 43586, 44667, 42918, 42616, 42618, 43506, 43577, 42974, 42619, 43425]
}

quest_line_names = {
    "You Are Now Prepared (Argus)": ["1. The Hand of Fate (Alliance)", "1. The Hand of Fate (Horde)", "2. Two If By Sea (Alliance)", "2. Two If By Sea (Horde)", "3. Light's Exodus", "4. The Vindicaar", "5. Into the Night", "6. Alone in the Abyss", "7. Righteous Fury", "8. Overwhelming Power", "9. A Stranger's Plea", "10. Vengeance", "11. Signs of Resistance", "12. The Prophet's Gambit", "13. Rendezvous", "14. From Darkness", "15. Prisoners No More", "16. Threat Reduction", "17. A Strike at the Heart", "18. Return to the Vindicaar", "19. A Moment of Respite", "20. Gathering Light", "21. A Grim Equation", "22. Crystals Not Included", "23. The Best Prevention", "24. Fire At Will", "25. Locating the Longshot", "26. Bringing the Big Guns", "27. Lightly Roasted", "28. The Light Mother", "29. Light's Return", "30. The Child of Light and Shadow", "31. Essence of the Light Mother", "32. An Offering of Light", "33. The Vindicaar Matrix Core", "34. The Burning Heart", "35. Securing a Foothold", "36. Reinforce Light's Purchase", "37. Reinforce the Veiled Den", "38. Sizing Up The Opposition", "1. The Speaker Calls", "2. Visions of Torment", "3. Dire News", "4. Storming the Citadel", "5. Scars of the Past", "6. Preventive Measures", "7. Chaos Theory", "8. Dark Machinations", "9. A Touch of Fel", "10. Heralds of Apocalypse", "11. Dawn of Justice", "12. Lord of the Spire", "13. Forming a Bond", "14. A Floating Ruin", "15. Mac'Aree, Jewel of Argus", "16. Defenseless and Afraid", "17. Khazaduum, First of His Name", "18. Consecrating Ground", "19. The Path Forward", "20. Not-So-Humble Beginnings", "21. Conservation of Magic", "22. Invasive Species", "23. The Longest Vigil", "24. Gatekeeper's Challenge: Tenacity", "25. Gatekeeper's Challenge: Cunning", "26. Gatekeeper's Challenge: Mastery", "27. The Defiler's Legacy", "28. The Sigil of Awakening", "1. Where They Least Expect It", "2. We Have a Problem", "3. A Non-Prophet Organization", "4. Wrath of the Hight Exarch", "5. Overt Ops", "6. Flanking Maneuvers", "7. Talgath's Forces", "8. What Might Have Been", "9. Across the Universe", "10. Shadow of the Triumvirate", "11. The Seat of the Triumvirate", "12. Whispers from Oronaar", "13. Arkhaan's Prayers", "14. The Pulsing Madness", "15. Arkhaan's Pain", "16. Arkhaan's Plan", "17. Arkhaan's Peril", "18. Throwing Shade", "19. Sources of Darkness", "20. The Shadowguard Incursion", "21. A Vessel Made Ready", "22. A Beacon in the Dark", "23. An Offering of Shadow", "24. The Netherlight Crucible*", "25. Seat of the Triumvirate: The Crest of Knowledge"],
    "Light's Heart": ["A Sign From The Sky (Paladin only)*", "A Falling Star", "Bringer of the Light", "Nobundo's Last Stand*", "Light's Charge", "Goddess Watch Over You*", "In the House of Light and Shadow", "Awakenings", "An Unclear Path", "Ravencrest's Legacy", "Felspawns of Lothros*", "The Red Axe*", "Hunter of Night*", "In My Father's House", "Destiny Unfulfilled*", "The Hunt for Illidan Stormrage", "Soul Prism of the Illidari", "Trial of Valor: The Once and Future Lord of Shadows", "The Nighthold"],
    "Balance of Power": ["The Power Within", "The Heart of Zin-Azshari", "A Vainglorious Past", "Fallen Power", "Tempering Darkness", "Lucid Stregnth", "The Wisdom of Patience", "Into Nightmares", "Essence of Power", "Essential Consumption", "Repaid Debt", "Lost Knowledge", "Borrowing Without Asking", "Rite of the Captain", "Literary Perfection", "Twisted Power", "A True Test", "Seeking the Valkyra", "The Mark", "Retrieving the Svalnguard", "A Feast for Odyn", "Presentation is Key", "Odyn's Blessing", "Planning the Assault", "Into the Nighthold", "The Nighthold: Delusions of Grandeur", "The Nighthold: Darkness Calls", "Balance of Power"],
    "Breaching the Tomb": ["1. Armies of Legionfall", "2. Assault on Broken Shore", "3. Seeking Lost Knowledge", "4. Legionfall Supplies", "5. Aalgen Point", "6. Vengeance Point", "7. Spiders, Huh? (Treasure chain)", "7a. Grave Robbin'", "7b. Tomb Raidering", "7c. Ship Graveyard", "7d. We're Treasure Hunters", "7e. The Motherlode", "8. Begin Construction", "8a. The Mage Tower", "8b. The Command Center", "8c. The Nether Disruptor", "9. Altar of the Aegis (Dungeon quest)", "13. Defending Broken Isles", "14. Champions of Legionfall", "15. Shard Times", "16. Mark of the Sentinax", "17. Self-Fulfilling Prophecy", "18. Intolerable Infestation", "19. Relieved of Their Valuables", "20. Take Out the Head...", "21. Championing Our Cause", "22. Strike Them Down"],
    "Good Suramaritan": ["The Valewalker's Burden", "Building an Army", "Seed of Hope", "Lady Lunastre", "One of the People", "Dispensing Compassion", "Special Delivery", "Shift Change", "Friends in Cages", "Little One Lost", "Friends On the Outside", "Thalyssra's Abode", "Thalyssra's Drawers", "The Gondolier", "All Along the Waterways", "Redistribution", "Moths to a Flame", "Make an Entrance", "The Fruit of Our Efforts", "How It's Made: Arcwine", "Intense Concentration", "The Old Fashioned Way", "Balance to Spare", "Silkwing Sabotage", "Reversal", "Vengeance for Margaux", "Seek the Unsavory", "Hired Help", "If Words Don't Work", "A Big Score", "Asset Security", "Make Your Mark", "And They Will Tremble", "The Perfect Opportunity", "Or Against Us", "Death Becomes Him", "Rumor Has It", "Either With Us", "Thinly Veiled Threats", "Vote of Confidence", "In the Bag", "Ly'leth's Champion", "Friends With Benefits", "The Arcway: Opening the Arcway", "Court of Stars: Beware the Fury of a Patient Elf", "The Arcway: Long Buried Knowledge", "Growing Strong", "A Growing Crisis", "Fragments of Disaster", "The Shardmaidens", "Another Arcan'dor Closes", "Branch of the Arcan'dor", "The Emerald Nightmare: The Stuff of Dreams", "A Change of Seasons", "Giving It All We've Got", "Ephemeral Manastorm Projector", "Flow Control", "Bring Home the Beacon", "Withered Progress", "All In", "Arcan'dor, Gift of the Ancient Magi", "Arluin's Request"],
    "Insurrection": ["1. One Day at a Time", "2. Silence in the City", "3. Crackdown", "4. Answering Aggression", "5. No Reason to Stay", "6. Regroup", "7. The Way Back Home", "8. Visitor in Shal'Aran", "1. Continuing the Cure", "2. Disillusioned Defector", "3. Missing Persons", "4. More Like Me", "5. Hostage Situation", "6. In the Business of Souls", "7. Smuggled!", "8. Waning Refuge", "1. A Message from Ly'leth", "2. Tavernkeeper's Fate", "3. Essence Triangulation", "4. On Public Display", "5. Waxing Crescent", "6. Sign of the Dusk Lily", "1. Stabilizing Suramar", "2. Eating Before the Meeting", "3. Take Me To Your Leader", "4. Down to Business", "A Better Future*", "5. Taking a Promenade", "5a. Nullified", "5b. Shield, Meet Spell", "5c. Crystal Clearing", "5d. Powering Down the Portal", "10. Break an Arm", "1. Feeding the Rebellion", "2. Tyrande's Command", "Mouths to Feed*", "3. Trolling Them", "4. Something's Not Quite Right. . . ", "5. Arming the Rebels", "6. Citizens' Army", "7. We Need Weapons", "8. Learning From the Dead", "9. Trial by Demonfire", "1. A United Front", "2. Ready for Battle", "3. Full Might of the Elves", "4. Staging Point", "1. Fighting on All Fronts", "2. Before the Siege", "3. Gates of the Nighthold", "4. Temporal Investigations", "5. Those Scrying Eyes", "6. Scouting the Breach", "7. The Seal's Power", "1. The Advisor and the Arcanist", "2. A Message From Our Enemies", "3. A Challenge From Our Enemies", "4a. The Felsoul Experiments", "5a. Telemantic Expanse", "4b. Resisting Arrest", "5b. Survey the City", "5c. Experimental Instability", "9. Felborne No More", "1. A Taste of Freedom", "2. I'll Just Leave This Here", "3. Breaching the Sanctum", "The Nighthold: Lord of the Shadow Council*", "Fate of the Nightborne*"],
    "Nightfallen But Not Forgotten": ["Khadgar's Discovery", "Magic Message", "Trail of Echoes", "The Only Way Out is Through", "The Nightborne Pact", "Arcane Thirst", "Shal'Aran", "Ancient Mana", "Oculeth's Workshop", "The Delicate Art of Telemancy", "Network Security", "Close Enough", "Hungry Work", "Survey Says", "An Old Ally", "A Re-Warding Effort", "Scattered Memories", "Written in Stone", "Subject 16", "Kel'danath's Legacy", "Sympathizers Among the Shal'dorei", "The Masks We Wear", "Blood of My Blood", "Masquerade	Masquerade", "First Contact", "Tapping the Leylines", "Power Grid	Feeding Shal'Aran", "Turtle Powered*", "Something in the Water*", "Purge the Unclean*", "Feeding Shal'Aran", "Leyline Apprentice", "Arcane Communion", "Scenes from a Memory", "Cloaked in Moonshade", "Breaking the Seal", "Moonshade Holdout", "Into the Crevasse", "The Hidden City", "The Valewalker's Burden"],
    "Shaman Class Campaign": ["1. A Ring Unbroken", "2. The Elements Call...", "(The Fist of Ra-den) The Coming Storm", "(The Fist of Ra-den) The Codex of Ra", "(The Fist of Ra-den) The Voice of Thunder", "(Sharas'dal) To the Deeps", "(Sharas'dal) Wavespeaker's Trail", "(Sharas'dal) Throne of the Tides: Azshara's Power", "(Doomhammer) Where the Hammer Falls", "(Doomhammer) What the Stonemother Knows", "(Doomhammer) The Troggs that Fel to Earth", "(Doomhammer) Stone Drake Rescue", "(Doomhammer) Clutch Play", "(Doomhammer) Needlerock Beatdown", "(Doomhammer) The Hammer in the Deep", "3. A Ring Reforged", "4. The Maelstrom Beckons", "5. Azeroth Needs You", "6. Call of the Earthen Ring", "7. Nobundo Awaits", "8. The Ritual of Tides", "9. Rise, Champions", "Champion: Stormcaller Mylra", "Champion: Duke Hydraxis", "10. Summoner Morn", "11. Recruiting The Troops", "12. Troops in the Field", "13. Tech It Up A Notch", "14. Mission: Elemental Diplomacy", "15. Supply Dropped", "16. Servant of the Windseeker", "17. Blessed Blade of the Windseeker", "18. The Skies Above", "19. Recharging the Blade", "20. Return of the Windlord", "Champion: Celestos", "Champion: Nobundo", "21. Recruiting Earthcallers", "22. Enemies of Air", "23. The Maelstrom Pillar: Air", "24. Mistral Essence", "25. Eye of Azshara: The Scepter of Storms", "26. A Vision of Triumph", "27. Speaking to the Wind", "28. Oath of the Windlord", "29. Mission: Investigating Deepholm", "30. The Great Stonemother", "31. The Return of Twilight", "32. Destroying the Cult", "33. The Master's Plan", "34. Unleashing the Elements", "35. Held Captive!", "36. The Twilight Master", "37. A Promise of Earth", "Champion: Muln Earthfury", "Champion: Avalanchion", "38. Return to the Firelands", "39. Ascendant of Flames", "40. Worldmender", "41. A Taste For Blood", "42. Return to Janai", "43. Neltharion's Lair: The Earthen Amulet", "44. The Firelord's Command", "45. The Brand of Damnation", "46. Allegiance of Flame", "Champion: Rehgar Earthfury", "Champion: Scaldius", "47. A Hero's Weapon"],
    "Death Knight Class Campaign": ["1. The Call To War", "2. A Pact of Necessity", "(Maw) The Dead and the Damned", "(Blades) The Call of Icecrown", "(Apocalypse) Apocalypse", "(Apocalypse) Following the Curse", "(Apocalypse) Disturbing the Past", "(Apocalypse) A Grisly Task", "(Apocalypse) The Dark Riders", "(Apocalypse) The Call of Vengeance", "3. Keeping Your Edge", "4. Advanced Runecarving", "5. Plans and Preparations", "6. Our Next Move", "7. Return of the Four Horsemen", "8. The Firstborn Rises", "9. Called to Acherus", "10. Rise, Champions", "Champion: Nazgrim", "Champion: Thassarian", "11. Spread the Word", "12. Recruiting the Troops", "13. Troops in the Field", "14. Salanar the Horseman", "15. Tech It Up A Notch", "16. The Ruined Kingdom", "17. Our Oldest Enemies", "18. Death... and Decay", "19. Regicide", "20. The King Rises", "Champion: Thoras Trollbane", "21. A Personal Request", "Champion: Koltira Deathweaver", "22. Steeds of the Damned", "23. Knights of the Ebon Blade", "24. Neltharion's Lair: Braid of the Underking", "25. Darkheart Thicket: The Nightmare Lash", "26. Armor Fit For A Deathlord", "27. The Scarlet Assault", "28. The Scarlet Massacre", "29. Raising an Army", "30. The Scarlet Commander", "31. The Zealot Rises", "32. Champion: High Inquisitor Whitemane", "33. Advancing the War Effort", "34. Aggregates of Anguish", "35. A Thirst For Blood", "36. Vault of the Wardens: A Masterpiece of Flesh", "Champion: Rottgut", "37. Eye of Azshara: The Frozen Soul", "Champion: Amal'thazad", "38. Maw of Souls: Maul of the Dead", "39. The Fourth Horseman", "40. Champion: Darion Mograine", "41. A Hero's Weapon"],
    "Rogue Class Campaign": ["1. Call of The Uncrowned", "2. The Final Shadow", "3. A Worthy Blade", "(Kingslayers) Finishing the Job", "(Kingslayers) No Sanctuary", "(Kingslayers) Codebreaker", "(Kingslayers) Cloak and Dagger", "(Kingslayers) Preparation", "(Kingslayers) The Unseen Blade", "(Dreadblades) A Friendly Accord", "(Dreadblades) The Dreadblades", "(Fangs) The Shadows Reveal", "(Fangs) A Matter of Finesse", "(Fangs) Closing In", "(Fangs) Traitor!", "(Fangs) Fangs of the Devourer", "4. Honoring Success", "5. Right Tools for the Job", "6. Injection of Power", "7. Return to the Chamber of Shadows", "8. Rise, Champions", "9. A More Wretched Hive of Scum and Villainy", "10. The School of Roguery", "11. The Big Bad Wolfe", "12. What Winstone Suggests", "13. A Body of Evidence", "14. Spy vs. Spy", "15. The Bloody Truth", "16. Mystery at Citrine Bay", "17. Searching For Clues", "18. Time Flies When Yer Havin' Rum!", "19. Dark Secrets and Shady Deals", "20. Champion: Lord Jorach Ravenholdt", "21. Convincin' Old Yancey", "22. Fancy Lads and Buccaneers", "23. Champion: Fleet Admiral Tethys", "24. Throwing SI:7 Off the Trail", "25. Blood for the Wolfe", "26. Maw of Souls: Ancient Vrykul Legends", "27. The Raven's Eye", "28. Off to Court", "29. A Sheath For Every Blade", "30. Noggenfogger's Reasonable Request", "31. Hitting the Books", "32. A Particularly Potent Potion", "33. Champion: Marin Noggenfogger", "34. In Search of the Eye", "35. Eternal Unrest", "36. Black Rook Hold: Into Black Rook Hold", "37. Deciphering the Letter", "38. Champion: Valeera Sanguinar", "39. Where In the World is Mathias?", "40. Pruning the Garden", "41. The World is Not Enough", "42. A Burning Distraction", "43. The Captive Spymaster", "44. Picking a Fight", "45. A Simple Plan", "46. Under Cover of Darkness", "47. The Imposter", "48. Champion: Taoshi", "49. Champion: Master Mathias Shaw", "50. One More Thing...", "51. A Hero's Weapon"],
    "Demon Hunter Class Campaign": ["1. Call of the Illidari", "2. The Power to Survive", "(Twinblades) Making Arrangements", "(Twinblades) By Any Means", "(Twinblades) The Hunt", "(Aldrachi) Asking a Favor", "(Aldrachi) Ask and You Shall Receive", "(Aldrachi) Return to Jace", "(Aldrachi) Establishing a Connection", "(Aldrachi) Vengeance Will Be Ours", "3. Eternal Vigil", "4. Securing the Way", "5. Return to Mardum", "6. Unbridled Power", "7. Spoils of Victory", "8. Cursed Forge of the Nathrezim", "9. Return to the Fel Hammer", "10. Rise, Champions", "11. Things Gaardoun Needs", "12. Broken Warriors", "13. Loramus, Is That You?", "14. Demonic Improvements", "15. Additional Accoutrements", "16. The Blood of Demons", "17. Immortal Soul", "18. Leader of the Illidari", "19. The Arcane Way", "20. Move Like No Other", "21. Confrontation at the Black Temple", "22. Into Our Ranks", "23. Unexpected Visitors", "24. Working With the Wardens", "25. Back in Black", "26. Deal With It Personally", "27. Malace in Vrykul Land", "28. Rune Ruination", "28a. Rune Ruination: Runeskeld Rollo", "28b. Rune Ruination: Runesage Floki", "28c. Rune Ruination: Runelord Ragnar", "29. Strange Bedfellows", "30. Vault of the Wardens: Vault Break-In", "31. The Crux of the Plan", "32. Two Worthies", "33. Preparations for Invasion", "34. Securing Mardum", "35. Green Adepts", "36. Hitting the Books", "37. You Will Be Prepared!", "38. One Battle at a Time", "39. A Very Special Kind of Fuel", "40. We'll Need Some Obliterum", "41. Deadlier Warglaives", "42. Jump-Capable", "43. A Final Offer", "44. The Invasion of Niskara", "45. Last, But Not Least", "46. I Am the Slayer!", "47. One More Thing...", "48. A Hero's Weapon"],
    "Warrior Class Campaign": ["1. A Desperate Plea", "1. An Important Mission", "2. Return to the Broken Shore (Alliance)", "2. Return to the Broken Shore (Horde)", "3. Odyn and the Valarjar", "4. Weapons of Legend", "(Strom'kar) The Sword of Kings", "(Warswords) The Hunter of Heroes", "(Scale) Legacy of the Icebreaker", "5. The Forgening", "6. The Forge of Odyn", "7. The Eye of Odyn", "8. Thus Begins the War", "9. Odyn's Summons", "10. The Firstborn Rises", "11. Champions of Skyhold", "Champion: Finna Bjornsdottir", "Champion: Ragnvald Drakeborn", "12. Captain Stahlstrom", "13. Recruiting the Troops", "14. Troops in the Field", "15. Einar the Runecaster", "16. The Gjallarhorn", "17. Break the Bonds", "18. Svergan's Promise", "19. On the Trail of the Great Worm", "Champion: Svergan Stormcloak", "20. To the Summit!", "21. Jorhuttam", "22. Preparing For War", "23. Recruiting Shieldmaidens", "24. Axe and You Shall Receive", "25. Hitting the Books", "26. Maw of Souls: Message to Helya", "27. Will of the Valarjar", "28. Demonic Runes", "Champion: Dvalen Ironrune", "Champion: Thorim", "29. Black Rook Hold: Greater Power", "30. Capturing the Gateway", "31. The Fate of Hodir", "32. Champion: Hodir", "33. A Hero's Weapon"]
}

alliance_quests = [47221, 47222, 42814, 42815]

horde_quests = [47835, 47867, 41052, 38904]

warrior_quests = [42814, 41052, 42815, 38904, 39654, 40579, 41105, 40043, 39191, 39530, 39192, 39214, 40585, 42597, 42484, 42598, 42606, 42605, 42607, 42609, 42610, 42611, 42193, 42650, 42651, 42107, 42614, 42110, 42204, 43585, 43975, 44255, 43888, 43586, 44667, 42918, 42616, 42618, 43506, 43577, 42974, 42619, 43425]
paladin_quests = [42866]
hunter_quests = []
rogue_quests = [40832, 40839, 40840, 42501, 42502, 42503, 42539, 42568, 42627, 40847, 40849, 41919, 41920, 41921, 41922, 41924, 40950, 40994, 40995, 43007, 42139, 42140, 43013, 43014, 43015, 43958, 43829, 44041, 44116, 44155, 44117, 44177, 44183, 43841, 43852, 44181, 42684, 43468, 43253, 43249, 43250, 44252, 42730, 43885, 44178, 44180, 43251, 43252, 42678, 42680, 42800, 43469, 43470, 43479, 43485, 43508, 37666, 37448, 37494, 37689, 43723, 43724, 44215, 43422]
priest_quests = []
death_knight_quests = [40714, 40715, 40740, 38990, 40930, 40931, 40932, 40933, 40934, 40935, 39757, 39761, 39832, 39799, 42449, 42484, 44550, 43264, 39818, 39816, 43265, 43266, 43267, 43539, 43268, 42533, 42534, 42535, 42536, 42537, 44243, 42708, 44244, 43899, 44082, 43571, 43572, 44217, 42818, 42882, 42821, 42823, 42824, 44245, 43573, 43928, 44690, 44286, 44246, 44282, 44247, 43574, 43686, 44248, 43407]
shaman_quests = [39746, 41335, 43334, 43338, 39771, 43644, 43645, 40341, 42931, 42932, 42933, 42935, 42936, 42937, 40224, 40225, 40276, 41510, 44544, 42188, 42114, 42383, 42198, 42197, 42141, 42142, 41741, 41740, 42184, 44101, 42977, 43002, 41770, 41771, 41776, 41742, 41743, 44465, 42986, 42996, 42983, 42984, 44253, 43886, 41901, 42200, 41775, 42068, 41777, 41897, 41898, 41899, 42065, 41900, 41746, 41747, 42208, 41772, 42988, 42995, 43003, 42990, 41773, 41934, 41888, 41744, 41745, 43418]
mage_quests = []
warlock_quests = []
monk_quests = []
druid_quests = []
demon_hunter_quests = [39261, 40814, 41120, 41121, 41119, 40247, 41804, 41806, 41807, 40249, 42869, 42872, 41033, 41037, 41062, 41064, 44087, 42671, 42677, 42679, 42681, 42683, 42682, 37447, 42510, 42522, 42593, 42594, 42921, 42665, 42131, 42731, 42801, 42787, 42735, 42736, 42737, 42739, 42738, 42749, 42752, 42775, 42776, 42669, 42802, 42808, 43878, 44213, 44694, 42733, 44616, 42732, 42754, 42810, 42920, 42132, 43186, 44214, 43412]


for key, questline in quest_lines.items():
    for quest in questline:

        # Check Faction requirements
        faction = []
        if quest in alliance_quests:
            faction = [0]
        elif quest in horde_quests:
            faction = [1]
        else:
            faction = [0, 1]

        # Check Class requirements
        class_restriction = []
        if quest in warrior_quests:
            class_restriction.append(1)
        elif quest in paladin_quests:
            class_restriction.append(2)
        elif quest in hunter_quests:
            class_restriction.append(3)
        elif quest in rogue_quests:
            class_restriction.append(4)
        elif quest in priest_quests:
            class_restriction.append(5)
        elif quest in death_knight_quests:
            class_restriction.append(6)
        elif quest in shaman_quests:
            class_restriction.append(7)
        elif quest in mage_quests:
            class_restriction.append(8)
        elif quest in warlock_quests:
            class_restriction.append(9)
        elif quest in monk_quests:
            class_restriction.append(10)
        elif quest in druid_quests:
            class_restriction.append(11)
        elif quest in demon_hunter_quests:
            class_restriction.append(12)
        elif not class_restriction:
            class_restriction = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12]

        # print(key)
        # print(questline.index(quest))
        # print(quest)
        # print(quest_line_names[key][questline.index(quest)])
        # print(faction)
        # print(class_restriction)

        table.put_item(
            Item={
                'quest_line': key,
                'quest_order': questline.index(quest),
                'quest_id': quest,
                'quest_name': quest_line_names[key][questline.index(quest)],
                'faction': faction,
                'class': class_restriction
            }
        )
